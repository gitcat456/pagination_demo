<!DOCTYPE html>
<html>
<head>
    <title>Pagination Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            background: #f8fafc; 
            color: #334155; 
            padding: 2rem; 
            line-height: 1.6;
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            padding: 2.5rem; 
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }
        h1 { 
            text-align: center; 
            margin-bottom: 2rem; 
            color: #1e293b;
            font-weight: 600;
        }
        .controls { 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1.25rem;
            background: #f1f5f9;
            border-radius: 8px;
        }
        select { 
            padding: 0.5rem; 
            border: 1px solid #cbd5e1; 
            border-radius: 6px;
            background: white;
        }
        .post { 
            background: white; 
            padding: 1.5rem; 
            margin: 1rem 0; 
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        .post:hover { 
            border-color: #3b82f6; 
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
        }
        .post h3 { 
            color: #1e293b; 
            margin-bottom: 0.5rem; 
            font-size: 1.1rem;
        }
        .post p { 
            color: #64748b; 
            margin-bottom: 0.5rem; 
        }
        .post small { 
            color: #94a3b8; 
        }
        .pagination { 
            display: flex; 
            justify-content: center; 
            align-items: center;
            margin: 2rem 0;
            gap: 0.75rem;
        }
        .pagination button { 
            padding: 0.75rem 1.5rem; 
            border: none; 
            background: #3b82f6; 
            color: white;
            border-radius: 6px; 
            cursor: pointer;
            font-weight: 500;
            transition: background 0.2s;
        }
        .pagination button:hover:not(:disabled) { 
            background: #2563eb; 
        }
        .pagination button:disabled { 
            background: #cbd5e1; 
            cursor: not-allowed;
        }
        .stats { 
            text-align: center; 
            color: #475569;
            font-weight: 500;
        }
        .loading {
            text-align: center; 
            padding: 2rem; 
            color: #64748b;
        }
        .spinner {
            border: 3px solid #f1f5f9;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1> Pagination Demo</h1>
        
        <div class="controls">
            <select id="limitSelect">
                <option value="5">5 per page</option>
                <option value="10" selected>10 per page</option>
                <option value="20">20 per page</option>
            </select>
            <div class="stats" id="stats"></div>
        </div>

        <div id="postsContainer">
            <div class="loading">
                <div class="spinner"></div>
                <p>Loading posts...</p>
            </div>
        </div>

        <div id="pagination" class="pagination"></div>
    </div>

    <script>
        let currentPage = 1;
        let currentLimit = 10;

        document.getElementById('limitSelect').addEventListener('change', (e) => {
            currentLimit = parseInt(e.target.value);
            currentPage = 1;
            loadPosts();
        });

        async function loadPosts() {
            const container = document.getElementById('postsContainer');
            container.innerHTML = `<div class="loading"><div class="spinner"></div><p>Loading posts...</p></div>`;

            try {
                const response = await fetch(`/api/posts?page=${currentPage}&limit=${currentLimit}`);
                const data = await response.json();

                if (data.success) {
                    displayPosts(data);
                    setupPagination(data.pagination);
                    updateStats(data.pagination);
                }
            } catch (error) {
                container.innerHTML = '<div class="loading">Error loading posts</div>';
            }
        }

        function displayPosts(data) {
            const container = document.getElementById('postsContainer');
            
            if (data.data.length === 0) {
                container.innerHTML = '<div class="loading">No posts found</div>';
                return;
            }

            container.innerHTML = data.data.map(post => `
                <div class="post">
                    <h3>${post.title}</h3>
                    <p>${post.content}</p>
                    <small>By: ${post.author} | ID: ${post.id}</small>
                </div>
            `).join('');
        }

        function setupPagination(pagination) {
            const container = document.getElementById('pagination');
            const { currentPage: page, totalPages, hasNext, hasPrev } = pagination;

            container.innerHTML = `
                <button onclick="changePage(${page - 1})" ${!hasPrev ? 'disabled' : ''}>← Previous</button>
                <span class="stats">Page ${page} of ${totalPages}</span>
                <button onclick="changePage(${page + 1})" ${!hasNext ? 'disabled' : ''}>Next →</button>
            `;
        }

        function updateStats(pagination) {
            const { totalItems, pageSize, currentPage } = pagination;
            const startItem = ((currentPage - 1) * pageSize) + 1;
            const endItem = Math.min(currentPage * pageSize, totalItems);
            
            document.getElementById('stats').textContent = 
                `Showing ${startItem}-${endItem} of ${totalItems}`;
        }

        function changePage(newPage) {
            currentPage = newPage;
            loadPosts();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Initialize
        loadPosts();
    </script>
</body>
</html>